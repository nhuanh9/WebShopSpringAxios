<!DOCTYPE html>
<html lang="en">
<head>
    <!-- basic -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- mobile metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <!-- site metas -->
    <title>pomato</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- bootstrap css -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- style css -->
    <link rel="stylesheet" href="css/style.css">
    <!-- Responsive-->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- fevicon -->
    <link rel="icon" href="images/fevicon.png" type="image/gif"/>
    <!-- Scrollbar Custom CSS -->
    <link rel="stylesheet" href="css/jquery.mCustomScrollbar.min.css">
    <!-- Tweaks for older IEs-->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
    <!-- owl stylesheets -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css"
          media="screen">
    <style>
        *{
            font-family: "Nunito", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
        }
    </style>
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.0/axios.min.js"></script>

</head>
<!-- body -->

<body class="main-layout ">
<!-- loader  -->
<div class="loader_bg">
    <div class="loader"><img src="images/loading.gif" alt="#"/></div>
</div>
<!-- end loader -->
<!-- header -->
<header>
    <!-- header inner -->
    <div class="header">

        <div class="container">
            <div class="row">
                <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col logo_section">
                    <div class="full">
                        <div class="center-desk">
                            <div class="logo">
                                <a href="index1.html"><img src="images/logo.png" alt="#"></a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9">
                    <div class="menu-area">
                        <div class="limit-box">
                            <nav class="main-menu">
                                <ul class="menu-area-main" id="menu">
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 offset-md-6">
                    <div class="location_icon_bottum">
                        <ul>
                            <li><span id="cartQuantity" style="color: white"
                                      onclick="redirectToCart()"> View card (0)</span></li>
<!--                            <li><a href="index1.html"> Ha Noi Shop</a></li>-->
<!--                            <li><a href="index2.html"> HCM Shop</a></li>-->
<!--                            <li><a href="index3.html">Da Nang Shop</a></li>-->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- end header inner -->
</header>
<!-- end header -->
<section class="slider_section">
    <div id="myCarousel" class="carousel slide banner-main" data-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img class="first-slide" style="width: 100%" src="images/anhlaptop1.jpg" alt="First slide">
                <div class="container">
                    <div class="carousel-caption relative">
                        <span>All New Laptop </span>
                        <h1>up to 25% Flat Sale</h1>

                        <a class="buynow" href="#">Buy Now</a>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <img class="second-slide" style="width: 100%" src="images/anhlaptop1.jpg" alt="Second slide">
                <div class="container">
                    <div class="carousel-caption relative">
                        <span>All New Laptop </span>
                        <h1>up to 25% Flat Sale</h1>
                        <a class="buynow" href="#">Buy Now</a>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <img class="third-slide" style="width: 100%" src="images/anhlaptop1.jpg" alt="Third slide">
                <div class="container">
                    <div class="carousel-caption relative">
                        <span>All New Laptop </span>
                        <h1>up to 25% Flat Sale</h1>
                        <a class="buynow" href="#">Buy Now</a>

                    </div>
                </div>
            </div>
        </div>
        <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
            <i class='fa fa-angle-left'></i>
        </a>
        <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
            <i class='fa fa-angle-right'></i>
        </a>
    </div>
</section>

<!-- about -->
<div class="about">
    <div class="container">
        <div class="row">
            <div class="col-xl-5 col-lg-5 col-md-5 co-sm-l2">
                <div class="about_img">
                    <figure><img src="images/anhlaptop.jpg" alt="img"/></figure>
                </div>
            </div>
            <div class="col-xl-7 col-lg-7 col-md-7 co-sm-l2">
                <div class="about_box">
                    <h3>About Us</h3>
                    <span>Our Laptop Shop</span>
                </div>

            </div>
        </div>
    </div>
</div>
<!-- end about -->

<!-- brand -->
<div class="brand">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="titlepage">
                    <h2>Our List Product</h2>

                    <div style="margin-top: 20px">
                        <select class="form-control" style="padding: 20px" onchange="loadFormSearch()" id="se">
                            <option class="form-control">-------------------------------------------</option>
                            <option class="form-control" value="1">Find By Name</option>
                            <option class="form-control" value="2">Find By Price</option>
                        </select>
                        <div id="search"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="brand-bg">
    <div class="container-fluid">
        <div class="row">
            <div class="col-8">
                <div class="row" id="list">
                </div>
            </div>
            <div class="col-md-4">
                <h3>Comments</h3>
                <div id="listComment" class="brand_box">
                </div>
                <div class="row mt-3">
                    <div class="col-8">
                        <input type="text" class="form-control" id="cmt">
                    </div>
                    <div class="col-4">
                        <span class="read-more" style="margin-top: 0 !important;" onclick="addComment()">Comment</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>


<!-- footer -->
<footer>
    <div id="contact" class="footer">
        <div class="container">
            <div class="row pdn-top-30">
                <div class="col-md-12 ">
                    <div class="footer-box">
                        <div class="headinga">
                            <h3>Address</h3>
                            <span>Healing Center, 176 W Streetname,New York, NY 10014, US</span>
                            <p>(+71) 8522369417
                                <br>demo@gmail.com</p>
                        </div>
                        <ul class="location_icon">
                            <li><a href="#"><i class="fa fa-facebook-f"></i></a></li>
                            <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="#"><i class="fa fa-instagram"></i></a></li>

                        </ul>
                        <div class="menu-bottom">
                            <ul class="link">
                                <li><a href="#">Home</a></li>
                                <li><a href="#">About</a></li>

                                <li><a href="#">Brand </a></li>
                                <li><a href="#">Specials </a></li>
                                <li><a href="#"> Contact us</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="copyright">
            <div class="container">
                <p>© 2019 All Rights Reserved. Design By<a href="https://html.design/"> Free Html Templates</a></p>
            </div>
        </div>
    </div>
</footer>

<!-- Modal -->
<div class="modal fade  modal-xl" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1"
     aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <!-- Cột ảnh sản phẩm -->
                    <div class="col-md-6">
                        <img src="link-to-product-image.jpg" class="img-fluid" id="img">
                    </div>

                    <!-- Cột thông tin sản phẩm -->
                    <div class="col-md-6">
                        <h2 id="name"></h2>
                        <h4 id="price"></h4>
                        <p id="category"></p>
                        <p id="supplier"></p>
                        <p id="des"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end footer -->
<!-- Javascript files-->
<script src="js/jquery.min.js"></script>
<script src="js/popper.min.js"></script>
<script src="js/bootstrap.bundle.min.js"></script>
<script src="js/jquery-3.0.0.min.js"></script>
<script src="js/plugin.js"></script>
<!-- sidebar -->
<script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="js/custom.js"></script>
<!-- javascript -->
<script src="js/owl.carousel.js"></script>
<script src="https:cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>
<script>
    $(document).ready(function () {
        $(".fancybox").fancybox({
            openEffect: "none",
            closeEffect: "none"
        });

        $(".zoom").hover(function () {

            $(this).addClass('transition');
        }, function () {

            $(this).removeClass('transition');
        });
    });
</script>
<script>

    loadComment()

    function loadComment() {
        axios.get('http://localhost:8080/comments').then(res => {
            let data = res.data;
            let str = '';
            for (let i = 0; i < data.length; i++) {
                str += `
                    <p style="text-align: start; padding-left: 30px">${data[i].user.username}: ${data[i].name}</p>`

            }
            document.getElementById('listComment').innerHTML = str;
        })
    }

    function addComment() {
        let data = {
            name: document.getElementById('cmt').value,
            user: {
                id: localStorage.getItem('user')
            }
        }
        axios.post('http://localhost:8080/comments', data).then(() => {
            loadComment();
            document.getElementById('cmt').value = ''
        })
    }

    axios.get('http://localhost:8080/products').then(res => {
        let data = res.data;
        let str = '';
        for (let i = 0; i < data.length; i++) {
            str += `<div class="col-xl-4 col-lg-4 col-md-4 col-sm-6 margin">
                        <div class="brand_box">
                            <img src="${data[i].image}" alt="img" class="mb-2"/>
                            <span>${data[i].name}</span>
                            <span>${data[i].price}</span>
                        <button onclick="addToCartAndRedirect(${data[i].id})" class="btn btn-outline-primary">Buy</button>
                        <button onclick="viewProduct(${data[i].id})" class="btn btn-outline-secondary">Detail</button>
                        </div>
                    </div>`

        }
        document.getElementById('list').innerHTML = str;
    })

    function viewProduct(id) {
        axios.get('http://localhost:8080/products/' + id).then(res => {
            $('#staticBackdrop').modal('show');
            document.getElementById('name').innerHTML = res.data.name;
            document.getElementById('price').innerHTML = res.data.price;
            document.getElementById('category').innerHTML = 'Category: ' + res.data.category.name;
            document.getElementById('supplier').innerHTML = 'Supplier: ' + res.data.supplier.name;
            document.getElementById('des').innerHTML = res.data.description;
            document.getElementById('img').src = res.data.image;
        })
    }

    function addToCartAndRedirect(productId) {
        if (localStorage.getItem('user') == null) {
            alert('You must login before buy anything');
            window.location.href = 'login.html';
            return;
        }
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        const productIndex = cart.findIndex(item => item.product.id === productId);
        if (productIndex > -1) {
            cart[productIndex].quantity += 1;
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartQuantityDisplay();
        } else {
            axios.get('http://localhost:8080/products/' + productId).then(res => {
                let data = res.data;
                cart.push({product: data, quantity: 1});
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartQuantityDisplay();
            })
        }


    }

    function updateCartQuantityDisplay() {
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let quantity = cart.reduce((sum, item) => sum + item.quantity, 0);
        document.getElementById('cartQuantity').textContent = `Giỏ hàng (${quantity})`;
    }

    function redirectToCart() {
        window.location.href = 'cart.html';
    }

    document.addEventListener('DOMContentLoaded', updateCartQuantityDisplay);

    function loadFormSearch() {
        let choice = document.getElementById('se').value;
        if (choice == 1) {
            document.getElementById('search').innerHTML =
                `<input type="text" class="form-control" id="search-name">
            <div style="background: red; display: inline; padding: 20px; border: 1px solid">
                <img src="images/search_icon.png" alt="icon" onclick="searchByName()"/>`
        } else {
            document.getElementById('search').innerHTML =
                `
            <input type="text" class="form-control" id="from">
            <input type="text" class="form-control" id="to">
            <div style="background: red; display: inline; padding: 20px; border: 1px solid">
                <img src="images/search_icon.png" alt="icon" onclick="searchByPrice()"/>`

        }
    }

    function searchByName() {
        let name = document.getElementById('search-name').value;
        axios.get('http://localhost:8080/products/findByName?name=' + name).then(res => {
            let data = res.data;
            let str = '';
            for (let i = 0; i < data.length; i++) {
                str += `<div class="col-xl-4 col-lg-4 col-md-4 col-sm-6 margin">
                        <div class="brand_box">
                            <img src="${data[i].image}" alt="img" />
                            <span>${data[i].name}</span>
                            <span>${data[i].price}</span>
                        <button onclick="addToCartAndRedirect(${data[i].id})" class="btn btn-outline-primary">Buy</button>
                        </div>
                    </div>`

            }
            document.getElementById('list').innerHTML = str;
        })
    }

    function searchByPrice() {
        let from = document.getElementById('from').value;
        let to = document.getElementById('to').value;
        axios.get('http://localhost:8080/products/findByPriceBetween?from=' + from + '&to=' + to).then(res => {
            let data = res.data;
            let str = '';
            for (let i = 0; i < data.length; i++) {
                str += `<div class="col-xl-4 col-lg-4 col-md-4 col-sm-6 margin">
                        <div class="brand_box">
                            <img src="${data[i].image}" alt="img" />
                            <span>${data[i].name}</span>
                            <span>${data[i].price}</span>
                        <button onclick="addToCartAndRedirect(${data[i].id})" class="btn btn-outline-primary">Buy</button>
                        </div>
                    </div>`

            }
            document.getElementById('list').innerHTML = str;
        })
    }

    function loadMenu() {
        let str = `
                                    <li class="active"><a href="index1.html">Shop 1</a></li>
                                    <li class="active"><a href="index2.html">Shop 2</a></li>
                                    <li class="active"><a href="index3.html">Shop 3</a></li>
        `
        if (localStorage.getItem('user') == null) {
            str += `
                                    <li><a href="login.html">Login</a></li>
                                    <li><a href="register.html">Register</a></li>`
        } else {
            str += `
                                    <li><a href="login.html">${JSON.parse(localStorage.getItem('user1')).username}</a></li>
                                    <li><a onclick="logout()">Logout</a></li>
`

        }
        document.getElementById('menu').innerHTML = str;
    }

    loadMenu()

    function logout() {
        localStorage.clear();
        window.location.href = 'login.html'
    }
</script>
</body>

</html>